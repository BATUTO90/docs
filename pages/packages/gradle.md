# Gradle

Buildkite Packages provides registry support for Gradle-based Java packages (using the [Maven Publish Plugin](https://docs.gradle.org/current/userguide/publishing_maven.html)).

Once your Java registry has been [created](/docs/packages/manage-registries#create-a-registry), you can publish/upload packages (generated from your application's build) to this registry by configuring your `build.gradle` file with the Gradle snippet presented on your Java registry's details page.

To view and copy the required `build.gradle` configurations:

1. Select _Packages_ in the global navigation to access the _Registries_ page.
1. Select your Java registry on this page.
1. Select _Publish a Java Package_ and in the resulting dialog's _Using Gradle with maven-publish plugin_ section, use the copy icon at the top-right of the code box to copy the Gradle code snippet and paste it into the appropriate area/s of your `build.gradle` file.

These `build.gradle` file configurations contain the:

- Maven coordinates for your package (which you will need to manually configure yourself)
- URL for your specific Java registry in Buildkite
- API write token (generated by Buildkite Packages) required to publish the package to this registry.

## Publish a package

The following steps describe the process above:

1. Copy the following Gradle snippet, and paste it to modify your `gradle.build` file accordingly:

    ```gradle
    // You require these plugins
    // "java": To publish java libraries
    // "maven-publish": To publish to Maven repositories
    ["java", "maven-publish"].each {
        apply plugin : it
    }

    // Donwload standard plugins, e.g., maven-publish  from GradlePluginPortal
    repositories {
      gradlePluginPortal()
    }

    // Define Maven repository to publish to
    publishing {
      publications {
        maven(MavenPublication) {

          // MODIFY: Define your Maven coordinates of your package
          groupId = "com.name.domain.my"
          artifactId = "my-java-package-name"
          version = "my-java-package-version"

          // Tell gradle to publish project's jar archive
          from components.java
        }
      }

      repositories {
        maven {
          // Define the Buildkite repository to publish to
          url "https://buildkitepackages.com/{org.slug}/{registry.name}/maven2/"
          credentials {
            username = "registry-write-token"
            password = ""
          }
        }
      }
    }
    ```

    where:
    * `registry-write-token` is the Buildkite Packages-generated API token required to publish/upload packages to your Java registry.

    <%= render_markdown partial: 'packages/java_package_domain_name_version' %>

    <%= render_markdown partial: 'packages/org_slug' %>

    <%= render_markdown partial: 'packages/java_registry_name' %>

1. Publish your package:

    ```bash
    gradle publish
    ```

## Access a package's details

<%= render_markdown partial: 'packages/access_java_package_details_page' %>

<%= render_markdown partial: 'packages/package_details_page_sections' %>

### Downloading a package

A Java package can be downloaded from the package's details page.

To download a package:

1. [Access the package's details](#access-a-packages-details).
1. Select _Download_.

### Installing a package

1. [Access the package's details](#access-a-packages-details).
1. Ensure the _Installation_ > _Installation instructions_ section is displayed.
1. Copy the code snippet and paste this into the `build.gradle` Gradle file, and execute this modified script file to install this package.

This code snippet is based on this format:

```gradle
// Add to 'build.gradle' file

// You require these plugins
// "java": To work with java libraries
['java' ].each {
  apply plugin : it
}

// maven type repository to download/install java packages from
repositories {
  maven {
    url "https://buildkitepackages.com/{org.slug}/{registry.name}/maven2/"
  }
}

// java package that you want to install
dependencies {
  compile "com.name.domain.my:my-java-package-name:my-java-package-version"
}
```

where:

- `{org.slug}` is the org slug.

<%= render_markdown partial: 'packages/java_registry_name' %>

<%= render_markdown partial: 'packages/java_package_domain_name_version' %>
