# Using Buildkite with Honeycomb

[Honeycomb](https://www.honeycomb.io/) is an observability and application performance management (APM) platform. Honeycomb integrates with Buildkite through two main methods - [buildevents binary](https://github.com/honeycombio/buildevents) and Honeycomb [Buildkite Markers](https://www.honeycomb.io/integration/buildkite-markers).

## Buildkite buildevents

Honeycomb's [buildevents binary](https://github.com/honeycombio/buildevents) is used for helping builds generate trace telemetry. The buildevents binary is usually invoked as part of each step in a build to capture invocation and output details. The trace generated at the end contains details about the events of the build.

The traces generated by buildevents contain spans for each section and subsection of the build. Each span represents individual or groups of the executed commands. 

The duration of each span is the runtime of the stage or specific command. Each span will also contain data on success or faiolure of a command and any additional data you choose to capture. Once a build finishes running, buildevents integration will ensures that your trace is sent to Honeycomb.

The buildevents script needs a unique Trace ID to join together all of the steps and commands with the build. You can use Buildkite's `BUILDKITE_BUILD_ID` environment variable since it is both unique (even when re-running builds, you will get a new `BUILDKITE_BUILD_ID`) and is also a primary value that the build system uses to identify the build.

You can find more information on the Honeycomb's [Buildkite buildevents page](https://www.honeycomb.io/integration/buildkite-buildevents) or you can get started by following the [installation instructions](https://github.com/honeycombio/buildevents?tab=readme-ov-file#installation) for buildevents.

## Buildkite Markers in Honeycomb

Honeycomb's [Buildkite Markers](https://www.honeycomb.io/integration/buildkite-markers) indicate points in time on your graphs where significant events, such as deploys or outages. You can list, create, update, and delete the Markers.

To add Buildkite Markers in Honeycomb, you can use the dedicated [open-source Buildkite plugin](https://github.com/tendnz/honeymarker-buildkite-plugin). This plugin adds Markers in the Honeycomb dataset for actions you want to note in Buildkite. The Buildkite Marker plugin uses the Honeycomb Markers API by running JQ and CURL to create markers. It requires configuration of the fields you will set in your markers.

To use the Honeycomb plugin in your Buildkite pipeline with all the available customizable options, add the following to your pipeline yaml configuration:

```yaml
steps:
  - command: make
    plugins:
      - tendnz/honeymarker#v1.0.{latest_plugin_version}:
          message: "v1.1.${BUILDKITE_BUILD_NUMBER}"
          writekey: ${HONEYCOMB_WRITE_KEY}
          dataset: "your-dataset-name"
          url: ${BUILDKITE_BUILD_URL}
          updatekey: "deploy-$ENV"
```

> ðŸš§ Warning!
> Please keep it in mind that this example is aimed at providing you with a basic understanding of how it is possible to use Buildkite with Honeycomb with the help of a plugin. For a production-ready implementation, we [strongly advise against](/docs/pipelines/security/secrets/risk-considerations) using secrets in plaintext pipeline files. Instead, the recommended way of handling secrets would be by using the [Buildkite secrets](https://buildkite.com/docs/pipelines/security/secrets/buildkite-secrets)-based approach. So you should put the actual secret values in your secrets and use the `ENV` name.

For more examples and description of the options, please refer to the Honeycomb Marker Buildkite Plugin's [readme](https://github.com/tendnz/honeymarker-buildkite-plugin/blob/master/README.md).
