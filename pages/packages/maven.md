# Maven

Buildkite Packages provides repository support for Maven-based packages for Java.

Once your Java package repository has been [created](/docs/packages/manage-repositories#create-a-repository), you can upload packages (generated from your application's build) to this repository by configuring your `~/.m2/settings.xml` and application's relevant `pom.xml` files with the Maven XML snippets presented on your Java package repository's details page.

To view and copy the required  `~/.m2/settings.xml` and `pom.xml` configurations:

1. Select _Packages_ in the global navigation to access the _Repositories_ page.
1. Select your Java package repository on this page.
1. Expand the _Publishing a package_ section and in the _Using Maven_ section, use the copy icon at the top-right of each respective code box to copy the relevant XML snippets and paste them into their respective files.

These file configurations contain the following:

- `~/.m2/settings.xml`: the ID for your specific Java package repository in Buildkite and authentication credentials (generated by Buildkite Packages) required to upload the package to this repository
- `pom.xml`: the reference to the required Maven plugin (to upload the package), along with the ID and URL for your specific Java (Maven) package repository in Buildkite.

## Publish a package

The following steps describe the process above:

1. Copy, paste and modify the following XML snippet in your `~/.m2/settings.xml` file:

    ```xml
    // Add to '~/.m2/settings.xml' under 'settings' xml tag
    <servers>
      <server>
        <id>org-slug-repository-name</id>
        <password>package-repository-write-token</password>
      </server>
    </servers>
    ```

    where:
    * `package-repository-write-token` is the Buildkite Packages-generated credentials required to access/upload packages to your Java package repository.

    <%= render_markdown partial: 'packages/java_package_repository_id' %>

    **Note:** The Java package repository ID can actually be any value. However, this value must match the ID used in your `pom.xml`.

1. Copy, paste and modify the following XML snippet in your `pom.xml` configuration file:

    ```xml
    // pluginsRepository: maven uses this plugin to push to repository
    <pluginRepositories>
      <pluginRepository>
        <id>computology-maven-packagecloud-wagon</id>
        <url>https://packagecloud.io/computology/maven-packagecloud-wagon/maven2</url>           
        <releases>
          <enabled>true</enabled>
        </releases>
      </pluginRepository>
    </pluginRepositories>

    // distributionManagement: 'maven deploy' pushes to this repository
    <distributionManagement>
      <repository>
        <id>org-slug-repository-name</id>
        <url>https://buildkitepackages.com/{org.slug}/{repository.name}</url>
      </repository>
      <snapshotRepository>
        <id>org-slug-repository-name</id>
        <url>https://buildkitepackages.com/{org.slug}/{repository.name}</url>
      </snapshotRepository>
    </distributionManagement>
    ```

    where:
    * `org-slug-repository-name` is the ID of your Java package repository (above).

    <%= render_markdown partial: 'packages/org_slug' %>

    <%= render_markdown partial: 'packages/java_package_repository_name' %>

1. Publish your package:

    ```bash
    mvn deploy
    ```

## Access a package's details

<%= render_markdown partial: 'packages/access_java_package_details_page' %>

<%= render_markdown partial: 'packages/package_details_page_sections' %>

### Downloading a package

A Java package can be downloaded from the package's details page.

To download a package:

1. [Access the package's details](#access-a-packages-details).
1. Select _Download_.

### Installing a package

1. [Access the package's details](#access-a-packages-details).
1. Ensure the _Installation_ > _Installation instructions_ section is displayed.
1. Copy the code snippet and paste this into the `pom.xml` file (under the `project` XML tag) to install this package.

The package code snippet is based on this format:

```xml
// Add this to 'pom.xml' under 'project' xml tag
<repositories>
  <repository>
    <id>org-slug-repository-name</id>
    <url>https://buildkitepackages.com/{org.slug}/{repository.name}/maven2/</url>
    <releases>
      <enabled>true</enabled>
    </releases>
    <snapshots>
      <enabled>true</enabled>
    </snapshots>
  </repository>
</repositories>

// Add this to 'pom.xml' under 'project' xml tag
<dependencies>
  <dependency>
    <groupId>com.name.domain.my</groupId>
    <artifactId>my-java-package-name</artifactId>
    <version>my-java-package-version</version>
  </dependency>
</dependencies>
```

where:

<%= render_markdown partial: 'packages/java_package_repository_id' %>

- `{org.slug}` is the org slug.

<%= render_markdown partial: 'packages/java_package_repository_name' %>

<%= render_markdown partial: 'packages/java_package_domain_name_version' %>
