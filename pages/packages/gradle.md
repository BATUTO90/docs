# Gradle

Buildkite Packages provides repository support for Gradle-based packages for Java using the [Maven Publish Plugin](https://docs.gradle.org/current/userguide/publishing_maven.html).

Once your Java package repository has been [created](/docs/packages/manage-repositories#create-a-repository), you can upload packages (generated from your application's build) to this repository by configuring your `build.gradle` file with the Gradle snippet presented on your Java package repository's details page.

To view and copy the required `build.gradle` configurations:

1. Select _Packages_ in the global navigation to access the _Repositories_ page.
1. Select your Java package repository on this page.
1. Expand the _Publishing a package_ section and in the _Using Gradle with maven-publish plugin_ section, use the copy icon at the top-right of the code box to copy the Gradle code snippet and paste it into the appropriate area/s of your `build.gradle` file.

These `build.gradle` file configurations contain the Maven coordinates for your package (which you will need to manually configure yourself), the URL for your specific Java (Gradle) package repository in Buildkite, and authentication credentials (generated by Buildkite Packages) required to upload the package to this repository.

## Publish a package

The following steps describe the process above:

1. Copy, paste and modify the following Gradle snippet in your `gradle.build` file:

    ```gradle
    // You require these plugins
    // "java": To publish java libraries
    // "maven-publish": To publish to Maven repositories
    ["java", "maven-publish"].each {
        apply plugin : it
    }

    // Donwload standard plugins, e.g., maven-publish  from GradlePluginPortal
    repositories {
      gradlePluginPortal()
    }

    // Define Maven repository to publish to
    publishing {
      publications {
        maven(MavenPublication) {

          // MODIFY: Define your Maven coordinates of your package
          groupId = "com.name.domain.my"
          artifactId = "my-java-package-name"
          version = "my-java-package-version"

          // Tell gradle to publish project's jar archive
          from components.java
        }
      }

      repositories {
        maven {
          // Define the Buildkite repository to publish to
          url "https://buildkitepackages.com/{org.slug}/{java.package.repository.name}/java/maven2/"
          credentials {
            username = "java-package-repository-credentials"
            password = ""
          }
        }
      }
    }
    ```

    where:
    <%= render_markdown partial: 'packages/java_package_domain_name_version' %>

    <%= render_markdown partial: 'packages/org_slug' %>

    <%= render_markdown partial: 'packages/java_package_repository_name' %>

1. Publish your package:

    ```bash
    gradle publish
    ```

## Access a package's details

<%= render_markdown partial: 'packages/access_java_package_details_page' %>

<%= render_markdown partial: 'packages/package_details_page_sections' %>

### Downloading a package

A Java (Jar) package can be downloaded from the package's details page.

To download a package:

1. [Access the package's details](#access-a-packages-details).
1. Select _Download_.

### Installing a package

1. [Access the package's details](#access-a-packages-details).
1. Ensure the _Installation_ > _Installation instructions_ section is displayed.
1. Copy the code snippet and paste this into the `build.gradle` Gradle file to install this package.

The package code snippet is based on this format:

```gradle
// Add to 'build.gradle' file

// You require these plugins
// "java": To work with java libraries
['java' ].each {
  apply plugin : it
}

// maven type repository to download/install java packages from
repositories {
  maven {
    url "https://buildkitepackages.com/priv/{api.token}/{org.slug}/{java.package.repository.name}/maven2/"
  }
}

// java package that you want to install
dependencies {
  compile "com.name.domain.my:my-java-package-name:my-java-package-version"
}
```

where:

- `{api.token}` (If this repository is public and if so, what happens to the `priv` in the path before this value? The current assumption is that both of these URL path components can be removed, with the `{api.token}` value passed in the header of the request.)

- `{org.slug}` is the org slug.

<%= render_markdown partial: 'packages/java_package_repository_name' %>

<%= render_markdown partial: 'packages/java_package_domain_name_version' %>
